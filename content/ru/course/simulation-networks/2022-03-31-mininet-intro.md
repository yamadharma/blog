---
title: "Введение в Mininet"
author: ["Dmitry S. Kulyabov"]
date: 2022-03-31T16:10:00+03:00
lastmod: 2022-05-05T18:28:00+03:00
tags: ["network", "education"]
categories: ["science", "computer-science"]
draft: false
weight: 201
toc: true
type: "book"
slug: "mininet-intro"
summary: "Введение в Mininet"
menu:
  "simulation-networks-lab":
    identifier: "введение-в-mininet"
    parent: "simulation-networks"
    weight: 201
---

Введение в средство натурного моделирования _Mininet_.

<!--more-->


## <span class="section-num">1</span> Настройка стенда виртуальной машины _Mininet_ {#настройка-стенда-виртуальной-машины-mininet}


### <span class="section-num">1.1</span> Общая информация {#общая-информация}

-   Репозиторий _Mininet_: <https://github.com/mininet/mininet>
-   Образ виртуальной машины: [mininet-2.3.0-210211-ubuntu-20.04.1-legacy-server-amd64-ovf](https://github.com/mininet/mininet/releases/download/2.3.0/mininet-2.3.0-210211-ubuntu-20.04.1-legacy-server-amd64-ovf.zip)


### <span class="section-num">1.2</span> Настройка образа {#настройка-образа}


#### <span class="section-num">1.2.1</span> VirtualBox {#virtualbox}

-   Распакуйте скачанный образ.
-   Импортируйте файл `.ovf`.
-   Перейдите в настройки.
-   Добавьте дополнительный сетевой адаптер _host-only network adapter_, который вы можете использовать для входа в образ виртуальной машины.


### <span class="section-num">1.3</span> Подключение к виртуальной машине {#подключение-к-виртуальной-машине}

-   Залогиньтесь в виртуальной машине:
    -   login: mininet
    -   password: mininet
-   Посмотрите адрес машины:

    ```shell
    ifconfig
    ```

    -   Внутренний адрес машины будет иметь вид 192.168.x.y.
-   Подключитесь к виртуальной машине (из терминала хостовой машины):

    ```shell
    ssh -Y mininet@192.168.x.y
    ```
-   Настройте вход по ключу (см. [Ключи ssh]({{< relref "2022-02-17-ssh-keys" >}})):

    ```shell
    ssh-copy-id mininet@192.168.x.y
    ```


### <span class="section-num">1.4</span> Настройка параметров _XTerm_ {#настройка-параметров-xterm}

-   По умолчанию _XTerm_ использует растровые шрифты, малого кегля.
-   Предлагается использовать векторные шрифты, кегль увеличить до 12--16 пунктов.
-   Для этого добавим в файл конфигурации `/etc/X11/app-defaults/XTerm`:

    ```conf-unix
    xterm*faceName: Monospace
    xterm*faceSize: 14
    ```

    -   Здесь выбран системный моноширинный шрифт, кегль шрифта --- 14 пунктов.


### <span class="section-num">1.5</span> Настройка соединения X11 для суперпользователя {#настройка-соединения-x11-для-суперпользователя}

-   При попытке запуска приложения из-под суперпользователя возникает ошибка:

    ```text
    X11 connection rejected because of wrong authentication.
    ```
-   Ошибка возникает из-за того, что X-соединение выполняется от имени пользователя `mininet`, а приложение запускается от имени пользователя `root` с использованием `sudo`.
-   Для исправления этой ситуации заполним файл полномочий `/root/.Xauthority`, используя утилиту `xauth`.
-   Для этого скопируем значение куки (MIT magic cookie) пользователя `mininet` в файл для пользователя `root`:

    ```shell
    mininet@mininet-vm:~$ xauth list $DISPLAY
    mininet-vm/unix:10  MIT-MAGIC-COOKIE-1  295acad8e35d17636924c5ab80e8462d

    mininet@mininet-vm:~$ sudo -i
    mininet@mininet-vm:~$ xauth list
    xauth:  file /root/.Xauthority does not exist
    root@mininet-vm:~# xauth add mininet-vm/unix:10  MIT-MAGIC-COOKIE-1  24fa6c77c26e2073d5b0d95e574e2456
    root@mininet-vm:~# xauth list $DISPLAY
    mininet-vm/unix:10  MIT-MAGIC-COOKIE-1  295acad8e35d17636924c5ab80e8462d
    ```

    -   Значение для _MIT-MAGIC-COOKIE_ приведено условно.
-   После этого должны запускаться графические приложения.


### <span class="section-num">1.6</span> Работа с Mininet из-под Windows {#работа-с-mininet-из-под-windows}


#### <span class="section-num">1.6.1</span> Варианты Xserver {#варианты-xserver}

-   Использовать можно любой вариант Xserver.

<!--list-separator-->

1.  VcXsrv Windows X Server

    -   Сайт: <https://sourceforge.net/projects/vcxsrv/>
    -   Лицензия: GPLv3.
    -   Компиляция: Visual C++ 2012 Express Edition

<!--list-separator-->

2.  Xming X Server

    -   Сайт: <http://www.straightrunning.com/XmingNotes/>
    -   Лицензия:
        -   _Public Domain Release_: MIT
        -   _Website Release_: за загрузку новых выпусков необходимо вносить плату; приобретение лицензии дает пользователю доступ к новым загрузкам в течение одного года.
    -   Компиляция: MinGW, Pthreads-Win32.


#### <span class="section-num">1.6.2</span> Установка программного обеспечения {#установка-программного-обеспечения}

-   Установите `putty`:

    ```shell
    choco install putty
    ```
-   Установите VcXsrv Windows X Server

    ```shell
    choco install vcxsrv
    ```


#### <span class="section-num">1.6.3</span> Запуск Xserver {#запуск-xserver}

-   Запустите `XLaunch`.
-   Выберите опции:
    -   _Multiple windows_;
    -   _Display number_: -1;
    -   _Start no client_.
-   Можно сохранить параметры, тогда при следующем запуске не нужно будет отмечать эти опции.


#### <span class="section-num">1.6.4</span> Запуск putty {#запуск-putty}

-   При подключении добавьте опцию перенаправления X11:
    -   Connection, SSH, X11 : _Enable X11 forwarding_.


## <span class="section-num">2</span> Обновление версии _Mininet_ {#обновление-версии-mininet}


### <span class="section-num">2.1</span> Настройка доступа к интернету {#настройка-доступа-к-интернету}

-   Добавьте в настройках Virualbox интерфейс _NAT_.
-   Загрузите виртуальную машину.
-   Залогиньтесь в виртуальной машине:
    -   login: mininet
    -   password: mininet
-   Посмотрите адрес машины:

    ```shell
    ifconfig
    ```
-   Должен быть активным адрес NAT: `10.0.0.x`.
-   Если вместо этого активен внутренний адрес машины вида `192.168.x.y`, то активируйте второй интерфейс наберите:

    ```shell
    sudo dhclient eth1
    ifconfig
    ```


### <span class="section-num">2.2</span> Обновление версии _Mininet_ {#обновление-версии-mininet}

-   Переименуйте предыдущую установку _Mininet_:

    ```shell
    mv ~/mininet ~/mininet.orig
    ```
-   Скачайте новую версию _Mininet_:

    ```shell
    cd ~
    git clone https://github.com/mininet/mininet.git
    ```
-   Обновите исполняемые файлы:

    ```shell
    cd ~/mininet
    sudo make install
    ```


## <span class="section-num">3</span> Основы работы в _Mininet_ {#основы-работы-в-mininet}


### <span class="section-num">3.1</span> Работа с Mininet с помощью командной строки {#работа-с-mininet-с-помощью-командной-строки}


#### <span class="section-num">3.1.1</span> Вызов Mininet с использованием топологии по умолчанию {#вызов-mininet-с-использованием-топологии-по-умолчанию}

-   Чтобы запустить минимальную топологию, введите команду:

    ```shell
    sudo mn
    ```
-   Эта команда запускает Mininet с минимальной топологией, состоящей из коммутатора, подключенного к двум хостам.
-   Чтобы отобразить список команд интерфейса командной строки Mininet и примеры их использования, введите команду в интерфейсе командной строки Mininet:

    ```shell
    help
    ```
-   Чтобы отобразить доступные узлы, введите команду:

    ```shell
    nodes
    ```
-   Вывод этой команды показывает, что есть два хоста (хост `h1` и хост `h2`) и коммутатор (`s1`).
-   Иногда бывает полезно отобразить связи между устройствами в Mininet, чтобы понять топологию. Введите команду `net` в интерфейсе командной строки Mininet, чтобы просмотреть доступные линки:

    ```shell
    net
    ```
-   Вывод этой команды показывает:
    -   Хост `h1` подключён через свой сетевой интерфейс `h1-eth0` к коммутатору на интерфейсе `s1-eth1`.
    -   Хост `h2` подключён через свой сетевой интерфейс `h2-eth0` к коммутатору на интерфейсе `s1-eth2`.
    -   Коммутатор `s1`:
        -   имеет петлевой интерфейс `lo`.
        -   подключается к `h1-eth0` через интерфейс `s1-eth1`.
        -   подключается к `h2-eth0` через интерфейс `s1-eth2`.
-   Mininet позволяет выполнять команды на конкретном устройстве. Чтобы выполнить команду для определенного узла, необходимо сначала указать устройство, а затем команду, например:

    ```shell
    h1 ifconfig
    ```
-   Эта команда выполняет команду `ifconfig` на хосте `h1`. Команда показывает интерфейсы хоста `h1`. Показано, что хост `h1` имеет интерфейс `h1-eth0`, настроенный с IP-адресом `10.0.0.1`, и другой интерфейс `lo`, настроенный с IP-адресом `127.0.0.1`.
-   Посмотрите конфигурацию всех узлов.


#### <span class="section-num">3.1.2</span> Проверка связности {#проверка-связности}

-   По умолчанию назначаются IP-адреса `10.0.0.1/8` и `10.0.0.2/8` узлам `h1` и `h2` соответственно. Чтобы проверить связь между ними, вы можете использовать команду `ping`. Команда `ping` работает, отправляя сообщения эхо-запроса протокола управляющих сообщений Интернета (ICMP) на удаленный компьютер и ожидая ответа.
-   Введите

    ```shell
    h1 ping 10.0.0.2
    ```
-   Эта команда проверяет соединение между хостами `h1` и `h2`. Чтобы остановить тест, нажмите `Ctrl+c`.
-   Остановите эмуляцию, набрав:

    ```shell
    exit
    ```
-   Заметим, что команда `sudo mn -c` часто используется в терминале для очистки предыдущего экземпляра Mininet (например, после сбоя).


### <span class="section-num">3.2</span> Построение и эмуляция сети в Mininet с использованием графического интерфейса {#построение-и-эмуляция-сети-в-mininet-с-использованием-графического-интерфейса}


#### <span class="section-num">3.2.1</span> Построение топологии сети {#построение-топологии-сети}

-   Запустите _MiniEdit_:

    ```shell
    sudo ~/mininet/mininet/examples/miniedit.py
    ```
-   Основные кнопки:
    -   `Select`: позволяет выбирать/перемещать устройства. Нажатие `Del` на клавиатуре после выбора устройства удаляет его из топологии.
    -   `Host`: позволяет добавить новый хост в топологию. После нажатия этой кнопки щелкните в любом месте пустого холста, чтобы вставить новый хост.
    -   `Switch`: позволяет добавить в топологию новый коммутатор. После нажатия этой кнопки щелкните в любом месте пустого холста, чтобы вставить переключатель.
    -   `Link`: соединяет устройства в топологии. После нажатия этой кнопки щелкните устройство и перетащите его на второе устройство, с которым необходимо установить связь.
    -   `Run`: запускает эмуляцию. После проектирования и настройки топологии нажмите кнопку запуска.
    -   `Stop`: останавливает эмуляцию.
-   Добавьте два хоста и один коммутатор.
-   Настройте IP-адреса на хостах `h1` и `h2`. IP-адрес хоста `h1` --- `10.0.0.1/8`, а IP-адрес хоста `h2` --- `10.0.0.2/8`. Хост можно настроить, удерживая правую кнопку мыши и выбирая свойства на устройстве.


#### <span class="section-num">3.2.2</span> Проверка связности {#проверка-связности}

-   Перед проверкой соединения между хостом `h1` и хостом `h2` необходимо запустить эмуляцию.
-   Нажмите кнопку _Run_, чтобы запустить эмуляцию. Начнётся эмуляция, и кнопки панели MiniEdit станут серыми, указывая на то, что в настоящее время они отключены.
-   Откройте терминал на хосте `h1`, удерживая правую кнопку мыши на хосте `h1` и выбрав _Terminal_. Это открывает терминал на хосте `h1` и позволяет выполнять команды на хосте `h1`.
-   Повторите процедуру на хосте `h2`.
-   На терминале хоста `h1` введите команду `ifconfig`, чтобы отобразить назначенные ему IP-адреса. Интерфейс `h1-eth0` на хосте `h1` должен быть настроен с IP-адресом `10.0.0.1` и маской подсети `255.0.0.0`.
-   Повторите эти действия на хосте `h2`. Его интерфейс `h2-eth0` должен быть настроен с IP-адресом `10.0.0.2` и маской подсети `255.0.0.0`.
-   На терминале хоста `h1` введите команду `ping 10.0.0.2`. Эта команда проверяет соединение между хостом `h1` и хостом `h2`.
-   Чтобы остановить тест, нажмите `Ctrl+c`.
-   Остановите эмуляцию, нажав кнопку _Stop_.


#### <span class="section-num">3.2.3</span> Автоматическое назначение IP-адресов {#автоматическое-назначение-ip-адресов}

-   Ранее мы вручную назначили IP-адреса узлам `h1` и `h2`.
-   В качестве альтернативы можно полагаться на Mininet для автоматического назначения IP-адресов.
-   Удалите назначенный вручную IP-адрес с хостов `h1` и `h2`.
-   Нажмите кнопку Edit &gt; Preferences. Базовые значения IP-адресов по умолчанию --- `10.0.0.0/8`. Измените это значение на `15.0.0.0/8`.
-   Запустите эмуляцию ещё раз, нажав кнопку _Run_. Начнётся эмуляция, и кнопки панели MiniEdit будут отключены.
-   Откройте терминал на хосте `h1`, удерживая правую кнопку мыши на хосте `h1` и выбрав _Terminal_.
-   Введите команду (чтобы отобразить IP-адреса, назначенные хосту `h1`):

    ```shell
    ifconfig
    ```
-   Интерфейс `h1-eth0` на узле `h1` теперь имеет IP-адрес `15.0.0.1` и маску подсети `255.0.0.0`.
-   Вы также можете проверить IP-адрес, назначенный хосту `h2`. Соответствующий интерфейс `h2-eth0` на хосте `h2` должен иметь IP-адрес `15.0.0.2` и маску подсети `255.0.0.0`.
-   Остановите эмуляцию, нажав кнопку _Stop_.


#### <span class="section-num">3.2.4</span> Сохранение и загрузка топологии Mininet {#сохранение-и-загрузка-топологии-mininet}

-   Часто бывает полезно сохранить топологию сети, особенно когда ее сложность возрастает. MiniEdit позволяет сохранить топологию в файл.
-   Чтобы сохранить топологию, нажмите _File_, затем _Save_. Укажите имя для топологии и сохраните на своем компьютере.
-   Сохраняйте в папку `~/work`. Для это предварительно создайте её:

    ```shell
    mkdir ~/work
    ```
-   После сохранения поменяйте права доступа к файлам в этой папке:

    ```shell
    sudo chown -R mininet:mininet ~/work
    ```
-   Для загрузки топологии нажмите _File_, затем _Open_.


## <span class="section-num">4</span> Видео {#видео}


### <span class="section-num">4.1</span> Youtube {#youtube}


#### <span class="section-num">4.1.1</span> Виртуальная машина _Mininet_ {#виртуальная-машина-mininet}

{{< youtube ZjA4bjiO_DM >}}


#### <span class="section-num">4.1.2</span> Работа с _Mininet_ из-под Windows {#работа-с-mininet-из-под-windows}

{{< youtube KPQMokxQ4Gw >}}


#### <span class="section-num">4.1.3</span> Основы работы в _Mininet_ {#основы-работы-в-mininet}

{{< youtube 0CT45dLWwJg >}}


#### <span class="section-num">4.1.4</span> Сохранение топологии _Mininet_ {#сохранение-топологии-mininet}

{{< youtube nllxRRUbWhg >}}


#### <span class="section-num">4.1.5</span> Обновление версии _Mininet_ {#обновление-версии-mininet}

{{< youtube Au193oRjZhI >}}


### <span class="section-num">4.2</span> Rutube {#rutube}


#### <span class="section-num">4.2.1</span> Виртуальная машина _Mininet_ {#виртуальная-машина-mininet}

{{< rutube 3afa7009a47f1f5d44d53e282d0d5fe4 >}}


#### <span class="section-num">4.2.2</span> Работа с _Mininet_ из-под Windows {#работа-с-mininet-из-под-windows}

{{< rutube c98ef1bb6b01c1e463854464e20cd1f3 >}}


#### <span class="section-num">4.2.3</span> Основы работы в _Mininet_ {#основы-работы-в-mininet}

{{< rutube 562ef53b91af0f61bc9de32986589d40 >}}


#### <span class="section-num">4.2.4</span> Сохранение топологии _Mininet_ {#сохранение-топологии-mininet}

{{< rutube dc30dc91ca8a64bb41cea98ad6902037 >}}


#### <span class="section-num">4.2.5</span> Обновление версии _Mininet_ {#обновление-версии-mininet}

{{< rutube 9e94e56ff5967c0bce0952a738b9761c >}}
