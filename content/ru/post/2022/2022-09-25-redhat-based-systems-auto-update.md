---
title: "Автообновление систем на базе деривативов RedHat"
author: ["Dmitry S. Kulyabov"]
date: 2022-09-25T09:42:00+03:00
lastmod: 2023-09-19T10:52:00+03:00
tags: ["redhat", "sysadmin", "linux"]
categories: ["computer-science"]
draft: false
slug: "redhat-based-systems-auto-update"
---

Простое автоматическое обновление на уровне хоста.

<!--more-->

{{< toc >}}


## <span class="section-num">1</span> Прагматика {#прагматика}

-   Основное преимущество автоматизации обновлений заключается в том, что машины, скорее всего, будут обновляться быстрее, чаще и более равномерно, чем если бы обновления выполнялись вручную.
-   Хотя необходимо быть осторожным с любым решением для автоматического обновления, его стоит рассмотреть, по крайней мере, для некоторых ситуаций.
-   Если машина является критическим сервером, для которого нельзя допускать незапланированного простоя службы на машине, то автоматические обновления использовать не следует. В противном случае можно использовать их.
-   Причины использования автоматических обновлений.
    -   Вы вряд ли будете применять обновления вручную по каким-либо причинам.
    -   Машина не критична, допустимы случайные незапланированные простои.
    -   Вы можете жить без удаленного доступа к машине, пока не сможете добраться до ее физического местоположения для решения проблем.
    -   У вас нет незаменимых данных на машине или надлежащих резервных копий таких данных.


## <span class="section-num">2</span> Общая информация {#общая-информация}

-   Документация: <https://dnf.readthedocs.io/en/latest/automatic.html>
-   Используются таймеры:
    -   `dnf-automatic.timer` : общий таймер, операции настраиваются в файле конфигурации;
    -   `dnf-automatic-notifyonly.timer` : уведомление о наличии обновлений;
    -   `dnf-automatic-download.timer` : загрузка обновлений;
    -   `dnf-automatic-install.timer` : установка обновлений.
-   Этим таймерам соответствуют сервисы.
-   Конфигурационный файл: `/etc/dnf/automatic.conf`.


## <span class="section-num">3</span> Установка программного обеспечения {#установка-программного-обеспечения}

-   Установим пакет:
    ```shell
    dnf install dnf-automatic
    ```


## <span class="section-num">4</span> Использование программного обеспечения {#использование-программного-обеспечения}

-   Зададим необходимую конфигурацию в файле `/etc/dnf/automatic.conf`.
-   Например, для автоматической установки обновлений зададим:
    ```conf-unix
    download_updates = yes
    apply_updates = yes
    ```
-   Запустим общий таймер:
    ```shell
    systemctl enable --now dnf-automatic.timer
    ```
-   Проверить работу таймера можно так:
    ```shell
    systemctl list-timers *dnf-* --all
    ```
