---
title: "Фильтры pandoc"
author: ["Dmitry S. Kulyabov"]
date: 2021-08-28T20:00:00+03:00
lastmod: 2023-07-15T20:40:00+03:00
tags: ["pandoc", "markdown"]
categories: ["computer-science"]
draft: false
slug: "pandoc-filters"
---

Фильтры _pandoc_.

<!--more-->

{{< toc >}}


## <span class="section-num">1</span> Общая информация {#общая-информация}

-   Фильтры --- основное средство расширения функционала pandoc.


## <span class="section-num">2</span> Варианты реализации фильтров {#варианты-реализации-фильтров}


### <span class="section-num">2.1</span> Фильтры на языке Haskell {#фильтры-на-языке-haskell}


#### <span class="section-num">2.1.1</span> Репозитории с фильтрами haskell {#репозитории-с-фильтрами-haskell}


### <span class="section-num">2.2</span> Фильтры на языке Python {#фильтры-на-языке-python}


#### <span class="section-num">2.2.1</span> Репозитории с фильтрами python {#репозитории-с-фильтрами-python}


### <span class="section-num">2.3</span> Фильтры на языке Lua {#фильтры-на-языке-lua}

-   Начиная с версии 2.0 pandoc содержит интерпретатор _lua_.
-   На данный момент используется версия lua 5.3.


#### <span class="section-num">2.3.1</span> Репозитории с фильтрами lua {#репозитории-с-фильтрами-lua}

<!--list-separator-->

1.  Основной набор фильтров lua

    -   Репозиторий: <https://github.com/pandoc/lua-filters>


#### <span class="section-num">2.3.2</span> Библиотеки для фильтров lua {#библиотеки-для-фильтров-lua}


#### <span class="section-num">2.3.3</span> Подключение дополнительных библиотек {#подключение-дополнительных-библиотек}

-   Фильтры могут потребовать использование дополнительных библиотек.
-   Для библиотек может понадобится задание пути расположения.
    -   Функция _lua_ `require` использует `package.path` для поиска модулей.
    -   При старте _lua_ инициализирует эту переменную значением переменной окружения `LUA_PATH` или значением по умолчанию из `luaconf.h`, если переменная окружения не определена.
    -   При поиске файла `require` использует путь, который немного отличается от обычных путей.
        -   Путь, используемый большинством программ, представляет собой список каталогов, в которых нужно искать данный файл.
        -   Однако ANSI C (абстрактная платформа, на которой работает Lua) не имеет концепции каталогов.
        -   Таким образом, путь, используемый `require`, представляет собой список шаблонов, каждый из которых указывает альтернативный способ преобразования имени модуля в имя файла.
    -   Путь --- это последовательность шаблонов, разделённых точкой с запятой.
        -   Любое вхождение строки `;;` в переменную среды окружения замещается значением по умолчанию.
            -   Например, если установить для `LUA_PATH` значение `mydir/?.lua;;`, окончательным путём будет компонент `mydir/?.lua`, за которым следует путь по умолчанию.
        -   Для каждого шаблона `require` будет заменять каждый вопросительный знак на имя файла `filename`.
    -   Пусть путь задан следующим образом:
        ```shell
        ?;?.lua;c:\windows\?;/usr/local/lua/?/?.lua
        ```

        -   В модуле делается вызов:
            ```lua
            require "sql"
            ```
        -   Ищутся файлы:
            ```shell
            sql
            sql.lua
            c:\windows\sql
            /usr/local/lua/sql/sql.lua
            ```
-   Я в проекте библиотеки размещаю в каталоге `pandoc/lua`, поэтому задаю переменную среды:
    ```shell
    LUA_PATH="pandoc/lua/?.lua;;"
    ```


## <span class="section-num">3</span> Фильтры по области применения {#фильтры-по-области-применения}


### <span class="section-num">3.1</span> Включения других файлов в документ {#включения-других-файлов-в-документ}

-   [Pandoc. Фильтры. Включение файлов]({{< relref "2023-03-23-pandoc-filters-include" >}})
