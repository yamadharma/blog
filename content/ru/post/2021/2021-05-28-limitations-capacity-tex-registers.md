---
title: "Ограничения ёмкости регистров TeX'а"
author: ["Dmitry S. Kulyabov"]
date: 2021-05-28T10:47:00+03:00
lastmod: 2023-07-20T13:33:00+03:00
tags: ["sysadmin", "tex"]
categories: ["computer-science"]
draft: false
slug: "limitations-capacity-tex-registers"
---

-   TeX --- достаточно старая программа. Он разрабатывался ещё в те времена, когда в моде была обратная совместимость (legacy). Он должен был одинаково работать при смене версии программного обеспечения.
-   TeX является мультиплатформенной программой. Он должен одинаково работать на разном оборудовании.

<!--more-->

{{< toc >}}


## <span class="section-num">1</span> Общие сведения {#общие-сведения}

-   В TeX есть набор ограничений, которые иногда мешают скомпилировать TeX-файл.
-   Эти ограничения вполне адекватны.
-   Возникновение таких проблем могут указывать на ошибку в файле.
-   Лучше всего внести исправления в исходный файл, чтобы подобные ошибки не возникали.
-   Но иногда без правки ограничений не обойтись.
-   Многие ограничения сняты в реализациях `XeTeX` и `LuaTeX`.


## <span class="section-num">2</span> Файлы для правки {#файлы-для-правки}


### <span class="section-num">2.1</span> TeX Live {#tex-live}

-   Рассматривается дистрибутив, установленный установщиком TeX Live (см. [Установка TeX Live]({{< relref "2021-04-23-install-texlive" >}})).
-   Системный уровень
    -   Все команды выполняются с полномочиями администратора:
        ```shell
        su -
        ```
    -   При обычной установке настройки делаются в каталоге
        ```shell
        /usr/local/texlive/texmf-local
        ```
    -   Локальные настройки для форматов TeX находятся в файле
        ```shell
        /usr/local/texlive/texmf-local/web2c/texmf.cnf
        ```
        Этот каталог задаётся переменной
        ```conf-unix
        TEXMFLOCAL
        ```
    -   После исправления файлов следует перегенерить форматы TeX:
        ```shell
        fmtutil-sys --all
        ```
-   Пользовательский уровень
    -   Все операции выполняются с полномочиями пользователя.
    -   При обычной установке настройки делаются в каталоге
        ```shell
        ~/texmf
        ```
        Этот каталог задаётся переменной
        ```conf-unix
        TEXMFHOME
        ```
    -   Настройки пользователя для форматов TeX находятся в файле
        ```shell
        ~/texmf/web2c/texmf.cnf
        ```
    -   После исправления файлов следует перегенерить форматы TeX:
        ```shell
        fmtutil-user --all
        ```


## <span class="section-num">3</span> Ошибки {#ошибки}


### <span class="section-num">3.1</span> Количество открытых файлов {#количество-открытых-файлов}

-   При компиляции ограничено количество открытых одновременно файлов.
-   Ошибка выглядит следующим образом:
    ```shell
    ! TeX capacity exceeded, sorry [text input levels=15].
    ```
-   Необходимо увеличить количество открытых одновременно файлов:
    ```conf-unix
    %% web2c/texmf.cnf
    %% simultaneous input files and error insertions, also applies to MetaPost
    max_in_open = 50
    ```
-   Здесь мы увеличили количество одновременно открытых файлов до 50.
