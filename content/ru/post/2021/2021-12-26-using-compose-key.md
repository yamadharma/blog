---
title: "Ввод с помощью Compose"
author: ["Dmitry S. Kulyabov"]
date: 2021-12-26T13:33:00+03:00
lastmod: 2023-10-02T16:37:00+03:00
categories: ["computer-science"]
draft: false
slug: "using-compose-key"
---

Ввод с помощью клавиши _Compose_.

<!--more-->

{{< toc >}}


## <span class="section-num">1</span> Общая информация {#общая-информация}

-   Клавиша `Compose` начинает последовательность нажатия клавиш, которая включает (обычно два) дополнительных нажатия клавиш.
-   Клавиша compose также известна под названием `Multi_key` в _X Window System_.
-   Используется либо для ввода символов на языке, для которого не была предназначена клавиатура, либо для других менее используемых символов.
-   Например, нажатие `Compose` + `'` + `e` производит `é`, или `Compose` + `-` + `-` создаёт длинное тире: `—`.


### <span class="section-num">1.1</span> US-International Keyboard {#us-international-keyboard}

-   Схожим проектом является _US-International Keyboard_ (международная клавиатура США)
-   <https://web.cortland.edu/ponterior/keyboard/>
-   В международной клавиатуре США в качестве клавиш-модификаторов используются `'`, `` ` ``, `~`, `^`, `"`.
-   Например, комбинация `'a` превращается в `á`, а `"o` --- в `ö`.
-   Если нужны символы-модификаторы как таковые, то после них набирается пробел.
-   Сочетание клавиш `Right-Alt` плюс `!`, `=` и ряд других клавиш для создания символов, которые обычно недоступны.
-   Недостаток американской международной клавиатуры в том, что она включает лишь символы западноевропейских языков.


## <span class="section-num">2</span> Настройка клавиши `Compose` {#настройка-клавиши-compose}

-   Хотя некоторые клавиатуры имеют железную клавишу `Compose`, её обычно переопределяют на какую-либо  другую клавишу.
-   Разрешённые клавиши для подстановки определены в `/usr/share/X11/xkb/rules/base.lst`:
    ```shell
    grep "compose:" /usr/share/X11/xkb/rules/base.lst
    ```
-   Чтобы просмотреть настройки _XKB_:
    ```shell
    setxkbmap -print -verbose 10
    ```
-   Например, чтобы сделать клавишу `Right Alt` клавишей `Compose`:
    -   через конфигурацию окружения рабочего стола,
    -   через конфигурационные файлы X. пропишите `compose:ralt` в `XkbOptions`:
        ```cfg
        # /etc/X11/xorg.conf.d/00-keyboard.conf
        Section "InputClass"
                Identifier "system-keyboard"
                ...
                Option "XkbOptions" "compose:ralt"
        EndSection
        ```
    -   используя `setxkbmap`:
        ```shell
        setxkbmap -option compose:ralt
        ```
    -   используя `localectl`
        -   `localectl` сохраняет настройки в файл `/etc/X11/xorg.conf.d/00-keyboard.conf`, который не следует редактировать вручную, потому что `localectl` перепишет его при следующем запуске.
        -   используйте следующим образом:
            ```shell
            localectl [--no-convert] set-x11-keymap раскладка [модель [вариант [опции]]]
            ```


## <span class="section-num">3</span> Сочетания клавиш {#сочетания-клавиш}

-   Комбинация по умолчанию для клавиши compose зависит от локали, установленной для этого сеанса.
-   Таблица символов находится в файле `/usr/share/X11/locale/используемая_локаль/Compose`, где `используемая_локаль`, к примеру, `en_US.UTF-8` или `ru_RU.UTF-8`.


### <span class="section-num">3.1</span> Таблица сочетаний {#таблица-сочетаний}

<div class="table-caption">
  <span class="table-number">&#1058;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072; 1:</span>
  Основные сочетания для клавиши <code>Compose</code>
</div>

| Первый символ | Второй символ | Результат                  |
|---------------|---------------|----------------------------|
| `'`           | a             | á                          |
| `"`           | a             | ä                          |
| `` ` ``       | a             | à                          |
| `~`           | a             | ã                          |
| `^`           | a             | â                          |
| `o`           | a             | å                          |
| `o`           | "             | ö                          |
| `,`           | c             | ç                          |
| `m`           | u             | µ                          |
| `"`           | u             | ü                          |
| `O`           | R             | ®                          |
| `<`           | &lt;          | «                          |
| `>`           | &gt;          | »                          |
| `.`           | ^             | ·                          |
| `x`           | x             | ×                          |
| `o`           | o             | °                          |
| `^`           | 2             | ²                          |
| `s`           | o             | /0                         |
| `1`           | 4             | ¼                          |
| `/`           | o             | ø (знак пустого множества) |
| `/`           | O             | Ø (знак диаметра)          |
| `-`           | d             | ð                          |
| `t`           | h             | þ                          |
| `a`           | e             | æ                          |
| `~`           | n             | ñ                          |
| `?`           | ?             | ¿                          |
| `=`           | E             | €                          |
| `f`           | s             | ſ                          |
| `'`           | A             | Á                          |
| `"`           | A             | Ä                          |
| `` ` ``       | A             | À                          |
| `~`           | A             | Ã                          |
| `^`           | A             | Â                          |
| `o`           | A             | Å                          |
| `s`           | s             | ß                          |
| `,`           | C             | Ç                          |
| `u`           | u             | ŭ                          |
| `O`           | C             | ©                          |
| `^`           | 3             | ³                          |
| `3`           | 4             | ¾                          |
| `T`           | H             | Þ                          |
| `A`           | E             | Æ                          |
| `!`           | !             | ¡                          |
| `=`           | Y             | ¥                          |


## <span class="section-num">4</span> Собственные сочетания клавиш {#собственные-сочетания-клавиш}

-   Можно определить собственную комбинацию клавиш _compose_.
-   Создайте пустой `~/.XCompose` и включите в него содержимое стандартного файла, используя директиву `include "%L"`, например:

<!--listend-->

```cfg
# ~/.XCompose
include "%L"

<Multi_key> <g> <a> : "α"
<Multi_key> <g> <b> : "β"
<Multi_key> <g> <g> : "γ"
```


## <span class="section-num">5</span> Примеры для набора собственных символов {#примеры-для-набора-собственных-символов}

-   Данные строчки добавляются в файл `~/.XCompose`.
    -   Знак рубля (_₽_):
        ```cfg
        <Multi_key><minus><p>:"₽"
        ```
    -   Русские ударения:
        ```cfg
        <Multi_key> <apostrophe> <apostrophe> : "́" U0301 # COMBINING ACUTE ACCENT
        ```

        -   Знак ударения вводится через последовательность клавиш `Compose` + `апостроф` + `апостроф`.
        -   Эту комбинацию клавиш надо нажимать после (справа) от буквы, на которой надо поставить ударение.
        -   Для латинских букв в _XCompose_ прописаны комбинации типа `Compose` + `апостроф` + `буква`:
            ```cfg
            <Multi_key> <apostrophe> <I>        : "Í"   Iacute # LATIN CAPITAL LETTER I WITH ACUTE
            ```
